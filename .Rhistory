if(return_upload_results){
return(upload_results)
}
}
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
upload_results
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
upload_results
upload_results
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
upload_results
upload_results
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
upload_results
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
source('C:/Users/SHeitmann/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash/R/upload_raw_data.R')
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
upload_results
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
LOGGED_IN_USER_ID <- 1
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
# Should be run from parent directory (traveldash)
library(openxlsx)
library(RPostgreSQL)
library(yaml)
library(DBI)
library(pool)
library(lubridate)
# Define whether on Joe's computer (dev) or elsewhere (prod)
joe <- grepl('joebrew', getwd())
if(joe){
dir <- getwd()
} else {
dir <- paste0(dirname(path.expand("~")),"/WBG/Sinja Buri - FIG SSA MEL/MEL Program Operations/Knowledge Products/Dashboards & Viz/WBG Travel/GitHub/traveldash")
setwd(dir)
}
# Source helper files
functions <- dir('R')
for(i in 1:length(functions))
{
if (functions[i]=="test_upload.R") next
else source(paste0('R/', functions[i]), chdir = TRUE)
}
pool <- create_pool(options_list = credentials_extract(),F)
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA Feb-15.xlsx")
file <- paste0(getwd(),"/dev_database/Travel Event Dashboard_DATA_20 Feb.xlsx")
data <- read.xlsx(file,sheet=1,startRow=2,detectDates=F)
LOGGED_IN_USER_ID <- 1
start_time <- Sys.time()
upload_results <- upload_raw_data(pool=pool,data=data,logged_in_user_id=LOGGED_IN_USER_ID,return_upload_results = TRUE)
end_time <- Sys.time()
print(paste0("Database upload time: ", end_time - start_time))
